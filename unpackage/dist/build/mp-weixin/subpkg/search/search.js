(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subpkg/search/search"],{"0d9b":function(e,t,r){"use strict";(function(e){r("b43d");n(r("66fd"));var t=n(r("549f"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,r("543d")["createPage"])},"195a":function(e,t,r){},"549f":function(e,t,r){"use strict";r.r(t);var n=r("df63"),s=r("a1dc");for(var i in s)"default"!==i&&function(e){r.d(t,e,(function(){return s[e]}))}(i);r("b89d");var o,a=r("f0c5"),u=Object(a["a"])(s["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],o);t["default"]=u.exports},6638:function(e,t,r){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(r("a34a"));function s(e){return e&&e.__esModule?e:{default:e}}function i(e,t,r,n,s,i,o){try{var a=e[i](o),u=a.value}catch(c){return void r(c)}a.done?t(u):Promise.resolve(u).then(n,s)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(n,s){var o=e.apply(t,r);function a(e){i(o,n,s,a,u,"next",e)}function u(e){i(o,n,s,a,u,"throw",e)}a(void 0)}))}}var a={data:function(){return{timer:null,is_icon:!0,searchValue:"",search_history:JSON.parse(e.getStorageSync("search_history")||"[]"),suggestList:[],goodsList:[]}},computed:{newSuggest:function(){var e=this,t=[];if(""!==this.searchValue){var r=new RegExp(this.searchValue,"g");return this.suggestList.forEach((function(n){t.push({name:n.name,named:n.name.replace(r,"<span style='color:#294D7C;'> "+e.searchValue+" </span>")})})),t}},goodsList1:function(){var e=this.goodsList;return e&&e.length?(e.forEach((function(e){e.img=e.image})),e):[]}},methods:{getSearchSuggest:function(){var t=this;return o(n.default.mark((function r(){return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.goodsList=[],""!=t.searchValue){r.next=3;break}return r.abrupt("return",t.suggestList=[]);case 3:clearTimeout(t.timer),t.timer=setTimeout(o(n.default.mark((function r(){var s,i;return n.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,e.$http.post("query_sku/",{query:t.searchValue});case 2:if(s=r.sent,i=s.data,200===i.code){r.next=7;break}return t.suggestList=[],r.abrupt("return",e.$showMsg(i.msg));case 7:t.suggestList=i.lists;case 8:case"end":return r.stop()}}),r)}))),700);case 5:case"end":return r.stop()}}),r)})))()},onSearch:function(t){var r=this;return o(n.default.mark((function s(){var i,o,a,u,c;return n.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=new Set(r.search_history),i.delete(t),i.add(t),r.search_history=Array.from(i).reverse(),e.setStorageSync("search_history",JSON.stringify(r.search_history)),r.searchValue=t,n.next=8,e.$http.post("query_sku_name/",{query:t});case 8:for(o=n.sent,a=o.data,r.suggestList=[],u=a.lists,c=0;c<u.length;c++)32!==u[c]["id"]&&33!==u[c]["id"]&&34!==u[c]["id"]||(u[c]["market_price"]=String((4*Number(u[c]["market_price"])).toFixed(2)),u[c]["price"]=String((4*Number(u[c]["price"])).toFixed(2)));r.goodsList=u;case 14:case"end":return n.stop()}}),s)})))()},search:function(e){this.onSearch(e.value)},clear:function(e){this.goodsList=[],this.suggestList=[]},history:function(t){this.searchValue=t,this.onSearch(t);var r=new Set(this.search_history);r.delete(t),r.add(t),this.search_history=Array.from(r).reverse(),e.setStorageSync("search_history",JSON.stringify(this.search_history))},clearHistory:function(t){if(t){var r=new Set(this.search_history);r.delete(t),this.search_history=Array.from(r).reverse()}else this.search_history=[];e.setStorageSync("search_history",JSON.stringify(this.search_history))},gotoGoodsDetail:function(t){e.navigateTo({url:"/subpkg/goods_detail/goods_detail?id=".concat(t.id,"&goods_stock=").concat(t.stock,"&goods_img=").concat(t.image)})}}};t.default=a}).call(this,r("543d")["default"])},a1dc:function(e,t,r){"use strict";r.r(t);var n=r("6638"),s=r.n(n);for(var i in n)"default"!==i&&function(e){r.d(t,e,(function(){return n[e]}))}(i);t["default"]=s.a},b89d:function(e,t,r){"use strict";var n=r("195a"),s=r.n(n);s.a},df63:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return n}));var n={uniSearchBar:function(){return r.e("uni_modules/uni-search-bar/components/uni-search-bar/uni-search-bar").then(r.bind(null,"7d13"))},uniIcons:function(){return Promise.all([r.e("common/vendor"),r.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(r.bind(null,"39de"))},homeGoodsitem:function(){return Promise.all([r.e("common/vendor"),r.e("components/home-goodsitem/home-goodsitem")]).then(r.bind(null,"f2e6"))}},s=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.is_icon=!1},e.e1=function(t){e.is_icon=!0})},i=[]}},[["0d9b","common/runtime","common/vendor"]]]);