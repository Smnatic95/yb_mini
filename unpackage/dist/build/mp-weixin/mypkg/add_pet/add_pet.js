(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["mypkg/add_pet/add_pet"],{"09dd":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(n("a34a")),a=n("2f62");function o(t){return t&&t.__esModule?t:{default:t}}function i(t){return d(t)||c(t)||s(t)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t,e){if(t){if("string"===typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(t,e):void 0}}function c(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function d(t){if(Array.isArray(t))return l(t)}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function f(t,e,n,r,a,o,i){try{var u=t[o](i),s=u.value}catch(c){return void n(c)}u.done?e(s):Promise.resolve(s).then(r,a)}function p(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(t){f(o,r,a,i,u,"next",t)}function u(t){f(o,r,a,i,u,"throw",t)}i(void 0)}))}}function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function h(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){b(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var g={data:function(){var t=this.getDate({format:!0});return{page_type:"add",addPetForm:{type:1,name:"",avatar:"",breed:"0",sex:"0",birthday:t,weight:"",state:"0",is_default:!1},breedName:"",breedArr:[],sexArr:["请选择宠物性别","弟弟","妹妹","保密"],stateArr:["请选择绝育状态","已绝育","未绝育","保密"],pet_info_init_is_default:null}},computed:h({isCatChecked:function(){return 1==this.addPetForm.type},startDate:function(){return this.getDate("start")},endDate:function(){return this.getDate(new Date)}},(0,a.mapState)("pet",["petList"])),onLoad:function(e){this.page_type=e.pet_id?"edit":"add","add"===this.page_type?t.setNavigationBarTitle({title:"添加宠物"}):(t.setNavigationBarTitle({title:"编辑宠物"}),this.pet_info_init_is_default=this.petList.find((function(t){return t.pet_id==e.pet_id})).is_default,this.addPetForm=this.petList.find((function(t){return t.pet_id==e.pet_id})),console.log("编辑宠物:",this.addPetForm)),this.getPetType()},onUnload:function(){t.removeStorageSync("select_pet")},methods:h(h({},(0,a.mapActions)("pet",["getpetlistFromOrigen"])),{},{submitForm:function(){var e=this;return p(r.default.mark((function n(){var a,o,i,u,s;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:a=e.addPetForm,console.log("表单内容：",a),n.t0=r.default.keys(a);case 3:if((n.t1=n.t0()).done){n.next=10;break}if(o=n.t1.value,0!==a[o]&&""!==a[o]){n.next=8;break}return console.log(o,0===a[o],""===a[o]),n.abrupt("return",t.$showMsg("宠物信息输入不完整"));case 8:n.next=3;break;case 10:if(i=t.getStorageSync("id"),i){n.next=14;break}return t.$showMsg("请先登录"),n.abrupt("return");case 14:if(a.user_id=i,"add"!==e.page_type){n.next=30;break}return n.prev=16,n.next=19,t.$http.post("pet_create/",{pet_list:a});case 19:u=n.sent,u.data,t.$showMsg("添加成功"),e.successCallback(),n.next=28;break;case 25:n.prev=25,n.t2=n["catch"](16),t.$showMsg("添加失败"+n.t2);case 28:n.next=42;break;case 30:return n.prev=30,n.next=33,t.$http.put("pet_edit/".concat(a.pet_id,"/"),{pet_list:a});case 33:s=n.sent,s.data,t.$showMsg("修改成功"),e.successCallback(),n.next=42;break;case 39:n.prev=39,n.t3=n["catch"](30),t.$showMsg("编辑失败"+n.t3);case 42:case"end":return n.stop()}}),n,null,[[16,25],[30,39]])})))()},chosseImg:function(){t.chooseImage({count:1,success:function(e){var n=e.tempFilePaths[0],r=e.tempFiles[0].size;console.log("图片大小",r),console.log("图片临时地址",n),r<=2e7?t.navigateTo({url:"../crop-pic/crop-pic?imgSrc="+n}):t.showToast({title:"上传图片不能大于20M!",icon:"none"})}})},deaultChange:function(){this.addPetForm.is_default=!this.addPetForm.is_default},successCallback:function(){var e=this;setTimeout((function(){e.getpetlistFromOrigen(),t.navigateBack(-1)}),1500)},getPetType:function(){var e=this;return p(r.default.mark((function n(){var a,o,u,s,c,d,l,f,p;return r.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=[],u=e.addPetForm.type,n.next=4,t.$http.get("pet_breed/"+u+"/");case 4:for(s=n.sent,c=s.data,o=c.lists,l=1===u?21:48,f=0;f<o.length;f++)o[f]["id"]===l&&(d=f);p=o.splice(d,1),o.splice(d,1),(a=o).push.apply(a,i(p)),o.unshift({name:"请选择宠物品种"}),e.breedArr=o;case 14:case"end":return n.stop()}}),n)})))()},radioClick:function(t){this.addPetForm.type=t,this.breedArr=[],this.addPetForm.breed="0",this.getPetType()},breedCange:function(t){this.addPetForm.breed=t.target.value},sexCange:function(t){this.addPetForm.sex=t.target.value},getDate:function(t){var e=new Date,n=e.getFullYear(),r=e.getMonth()+1,a=e.getDate();return"start"===t?n-=60:"end"===t&&(n+=2),r=r>9?r:"0"+r,a=a>9?a:"0"+a,"".concat(n,"-").concat(r,"-").concat(a)},birthdayChange:function(t){console.log(t.target.value),this.addPetForm.birthday=t.target.value},stateCange:function(t){this.addPetForm.state=t.target.value}})};e.default=g}).call(this,n("543d")["default"])},"316d":function(t,e,n){"use strict";n.r(e);var r=n("09dd"),a=n.n(r);for(var o in r)"default"!==o&&function(t){n.d(e,t,(function(){return r[t]}))}(o);e["default"]=a.a},"4ba9":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return r}));var r={uniForms:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-forms/components/uni-forms/uni-forms")]).then(n.bind(null,"8862"))},uniFormsItem:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-forms/components/uni-forms-item/uni-forms-item")]).then(n.bind(null,"70d5"))},uniEasyinput:function(){return Promise.all([n.e("common/vendor"),n.e("uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput")]).then(n.bind(null,"2c66"))}},a=function(){var t=this,e=t.$createElement;t._self._c},o=[]},bd23:function(t,e,n){},d391:function(t,e,n){"use strict";var r=n("bd23"),a=n.n(r);a.a},da41:function(t,e,n){"use strict";n.r(e);var r=n("4ba9"),a=n("316d");for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);n("d391");var i,u=n("f0c5"),s=Object(u["a"])(a["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],i);e["default"]=s.exports},dd5b:function(t,e,n){"use strict";(function(t){n("b43d");r(n("66fd"));var e=r(n("da41"));function r(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])}},[["dd5b","common/runtime","common/vendor"]]]);